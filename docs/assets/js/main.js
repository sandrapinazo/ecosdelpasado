"use strict";const newsUlEl=document.querySelector(".news-ul"),locationsUlEl=document.querySelector(".locations-container"),pageTitle=document.querySelector(".page-title"),createNewsEl=document.querySelector(".location-tab__create-news"),formEl=document.querySelector(".create-news--form"),formButtonEl=document.querySelector(".form-button"),formCloseEl=document.querySelector(".form-button-close"),inputEl=document.querySelectorAll(".form-input");let newNews={},allNews=[];function writeNews(e){clearNews(),e.sort(function(e,t){return e.date>t.date?-1:e.date<t.date?1:0});for(const t of e){const e=document.createElement("li");e.classList.add("news-container");const n=document.createElement("article");n.classList.add("news");const o=document.createElement("h3");o.classList.add("news-title");const c=document.createElement("p");c.classList.add("news-main");const l=document.createElement("span");l.classList.add("news-location");const s=document.createTextNode(t.title),a=document.createTextNode(t.main),i=document.createTextNode(t.location),r=document.createTextNode(" â€¢ "),d=document.createTextNode(t.date);o.appendChild(s),c.appendChild(a),l.appendChild(i),l.appendChild(r),l.appendChild(d),n.appendChild(o),n.appendChild(c),e.appendChild(l),e.appendChild(n),newsUlEl.appendChild(e)}}function writeLocations(e){locationsUlEl.innerHTML="";let t=[];for(const n of e)t.includes(n.location)||t.push(n.location);t.sort(),t.splice(0,0,"Thea");for(const e of t){const t=document.createElement("li"),n=document.createTextNode(e);t.appendChild(n),t.classList.add("location-tab"),"Thea"===e&&t.classList.add("Thea"),t.addEventListener("click",filterLocation),locationsUlEl.appendChild(t)}}function filterLocation(e){const t=e.currentTarget.innerHTML;writeNews(allNews.filter(e=>"Thea"===t?e.location:e.location===t));const n=locationsUlEl.querySelectorAll(".location-tab");for(const e of n)e.classList.remove("selected-location-tab");e.currentTarget.classList.add("selected-location-tab")}function clearNews(){newsUlEl.innerHTML=""}function showForm(){formEl.classList.remove("hidden")}function handleCreateNews(){if(checkInputsFilled()){getValueFromInputs(),allNews.push(newNews),updateJson({news:allNews}),closeForm()}else alert("Rellena todos los campos")}function getValueFromInputs(){for(const e of inputEl){const t=e.id;newNews[t]=e.value}}function closeForm(){formEl.classList.add("hidden"),newNews={}}function checkInputsFilled(){for(const e of inputEl)if(!e.value)return!1;return!0}function updateJson(e){fetch("https://api.myjson.com/bins/1ccibi",{method:"PUT",body:JSON.stringify(e),headers:{"content-type":"application/json"}}).then(e=>e.json()).then(function(e){const{news:t}=e;writeNews(t),writeLocations(t),allNews=t}).catch(e=>console.log("error",e))}"News"===pageTitle.innerHTML&&fetch("https://api.myjson.com/bins/1ccibi").then(e=>e.json()).then(function(e){const{news:t}=e;allNews=t,writeNews(t),writeLocations(t)}),createNewsEl.addEventListener("click",showForm),formButtonEl.addEventListener("click",handleCreateNews),formCloseEl.addEventListener("click",closeForm);